Author: Joseph Lee
E-Mail: fdlixiaojun@gmail.com

地址解析协议ARP和反向地址解析协议RARP

ARP协议为IP地址到对应的硬件地址之间提供动态映射。

数据报发送时需要知道目的主机的IP地址和链路层地址，通过DNS服务或者hosts文件或者
直接指定得到目的主机的IP地址，通过ARP协议来发现目的主机的链路层地址。
注意：这里两个目的主机代表的意义可能不同，当跨网络中间要经过路由器时，路由器会
将自己的链路层地址返回给ARP请求端，这个叫做ARP代理或者ARP委托。
点对点链路不使用ARP，而是在设置链路时直接告知内核每一端的IP地址。

关于ARP高速缓存
每个主机上都有一个ARP高速缓存，保存了最近IP地址到链路层地址之间的映射记录。

关于ARP分组格式
+--------+------+------+--------+----+--+--+--+--------+------+--------+------+
|目的地址|源地址|帧类型|硬件类型|协议|HL|PL|OP|发端地址|发端IP|目的地址|目的IP|
+---6----+---6--+--2---+----2---+-2--+1-+1-+2-+---6----+--4---+---6----+---4--+
|<-----以太网头部----->|<-------------28字节的ARP请求/应答------------------->|

HL指硬件地址长度
PL指协议地址长度
OP指执行的操作，包括ARP请求（1），ARP应答（2），RARP请求（3）和RARP应答（4）。

ARP请求帧头部的目的地址被设置为全1，表示广播，请求信息部分的目的物理地址被设置
为全0。当系统收到一个目的端为本机的ARP请求后，就把自己的硬件地址填进去，然后用
两个两个目的端地址替换两个发送端地址，然后更改操作类型为ARP应答，再把它发送回去

gratuitous ARP
主机发送ARP查找自己的IP地址，用于通知网络中其它主机自己IP地址更新或者查看有无IP
地址冲突。

关于RARP
没有本地磁盘，不知道本机IP地址，这时使用RARP来获得自己的IP地址。
通过给出硬件地址，来发送一帧RARP请求，请求某个主机响应该硬件地址对应的IP地址。
RARP分组格式和ARP一样，不同在于帧类型和操作代码不同。

ARP，RARP请求一般以广播方式发送，ARP，RARP应答一般是单播发送的。

RARP服务器要比ARP复杂，复杂性在于服务器一般要为多个主机（网络上的所有无盘系统）
提供硬件地址到IP地址的映射。该映射包含在一个磁盘文件中，位于/etc/ethers。由于内
核一般不读取和分析磁盘文件，因此RARP服务器的功能由用户进程来提供，而不是作为内
核的TCP/IP实现的一部分。
